import pandas as pd

# df1 が元のデータフレームだとする

# 年と月で条件を指定して絞り込み
df1_filtered = df1[
    (df1['year'] >= 2010) & (df1['year'] <= 2022) &
    (df1['month'].isin([11, 12, 1, 2, 3]))
]

# 場所ごと・日ごとの最高・平均・最低気温を計算して df11 に代入
daily_stats = df1_filtered.groupby(['place', 'year', 'month', 'day'])['temp'].agg(
    max_temp='max',
    mean_temp='mean',
    min_temp='min'
).reset_index()

# 平均気温を小数点2桁に丸める（任意）
daily_stats['mean_temp'] = daily_stats['mean_temp'].round(2)

print(daily_stats)
